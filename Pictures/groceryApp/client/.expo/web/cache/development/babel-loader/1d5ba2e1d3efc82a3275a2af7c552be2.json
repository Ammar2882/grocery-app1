{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\ammar\\\\Pictures\\\\groceryApp\\\\client\\\\screens\\\\admin\\\\Home.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from \"react\";\nimport constants from \"expo-constants\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport Icon from \"@expo/vector-icons/AntDesign\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport \"../../global\";\nimport { useDispatch } from \"react-redux\";\nexport default function Home(props) {\n  var _this = this;\n\n  var _useState = useState({\n    loading: true,\n    edit: false,\n    jarNames: \"\",\n    currlevel: \"\",\n    jarname: \"\",\n    adminID: \"\",\n    iotToken: ''\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      state = _useState2[0],\n      setState = _useState2[1];\n\n  var dispatch = useDispatch();\n  useEffect(function () {\n    getAdminId();\n  }, []);\n\n  var getAdminId = function getAdminId() {\n    var afterParse, adminId, iotToken;\n    return _regeneratorRuntime.async(function getAdminId$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.t0 = JSON;\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"item\"));\n\n          case 3:\n            _context.t1 = _context.sent;\n            afterParse = _context.t0.parse.call(_context.t0, _context.t1);\n            adminId = afterParse.adminId;\n            iotToken = afterParse.iotToken;\n            console.log(\"Admin ID: \" + adminId);\n            console.log(\"Iot Token: \" + iotToken);\n            setState(function (prevState) {\n              return _objectSpread(_objectSpread({}, prevState), {}, {\n                adminID: adminId,\n                iotToken: iotToken\n              });\n            });\n            fetchData(adminId);\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var fetchData = function fetchData(adminId) {\n    setState(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        loading: true\n      });\n    });\n    fetch(global.ipAddress + \":3001/getHomeData/\" + adminId).then(function (res) {\n      return res.json();\n    }).then(function (resJson) {\n      console.log(resJson);\n      setState(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, {\n          jarNames: resJson,\n          loading: false\n        });\n      });\n      console.log(\"Loading is \" + state.loading);\n    }).catch(function (e) {\n      return console.log(e);\n    });\n  };\n\n  var getValues = function getValues(val) {\n    if (val >= 0 && val <= 10) {\n      SendMail();\n      return React.createElement(Text, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 14\n        }\n      }, \"high\");\n    } else if (val >= 11 && val <= 16) {\n      return React.createElement(Text, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 14\n        }\n      }, \"Medium\");\n    } else if (val >= 17 && val <= 22) {\n      return React.createElement(Text, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 14\n        }\n      }, \"low\");\n    } else {\n      return React.createElement(Text, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 19\n        }\n      }, \"Invalid\");\n    }\n  };\n\n  var onAddJar = function onAddJar() {\n    setState(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        jarname: \"\"\n      });\n    });\n    fetch(global.ipAddress + \":3001/addJar/\" + state.adminID, {\n      method: \"PUT\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        jarName: state.jarname\n      })\n    }).then(function (res) {\n      return res.json();\n    }).then(function (resJson) {\n      console.log(resJson);\n      console.log(\"added\");\n    }).catch(function (e) {\n      return console.log(e);\n    });\n  };\n\n  var SendMail = function SendMail() {\n    fetch(global.ipAddress + \":3001/sendMail/\" + state.adminID, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(function (res) {\n      return res.text();\n    }).then(function (resJson) {\n      console.log(resJson);\n    });\n  };\n\n  var onDelete = function onDelete(jarName) {\n    setState(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        edit: false\n      });\n    });\n    fetchData();\n    fetch(global.ipAddress + \":3001/deleteJarItem/\" + state.adminID + \"/\" + jarName, {\n      method: \"PUT\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (resJson) {\n      console.log(resJson);\n    }).catch(function (e) {\n      return console.log(e);\n    });\n  };\n\n  var handleRefresh = function handleRefresh() {\n    getAdminId();\n  };\n\n  var renderSeparator = function renderSeparator() {\n    return React.createElement(View, {\n      style: {\n        marginBottom: -10\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 5\n      }\n    });\n  };\n\n  return React.createElement(React.Fragment, null, React.createElement(FlatList, {\n    refreshing: state.loading,\n    onRefresh: handleRefresh,\n    data: state.jarNames,\n    renderItem: function renderItem(_ref) {\n      var item = _ref.item,\n          index = _ref.index;\n      return React.createElement(TouchableOpacity, {\n        key: index,\n        onPress: function onPress() {\n          dispatch({\n            type: \"navigate\",\n            payload: {\n              jarname: item.key,\n              iotToken: item.iotToken\n            }\n          });\n          props.navigation.navigate(\"History\", item);\n        },\n        onLongPress: function onLongPress() {\n          return setState(function (prevState) {\n            return _objectSpread(_objectSpread({}, prevState), {}, {\n              edit: true\n            });\n          });\n        },\n        style: styles.card,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 11\n        }\n      }, React.createElement(View, {\n        style: styles.jarNameContainer,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161,\n          columnNumber: 13\n        }\n      }, React.createElement(Text, {\n        style: styles.jarText,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 15\n        }\n      }, item.key), React.createElement(View, {\n        style: styles.pill,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163,\n          columnNumber: 15\n        }\n      }, getValues(item.value)), state.edit ? React.createElement(Icon, {\n        onPress: function onPress() {\n          return onDelete(item.jars);\n        },\n        style: {\n          marginRight: 20\n        },\n        name: \"close\",\n        size: 19,\n        color: \"red\",\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 17\n        }\n      }) : null));\n    },\n    ItemSeparatorComponent: renderSeparator,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 7\n    }\n  }), React.createElement(View, {\n    style: styles.addWrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: styles.inputView,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 9\n    }\n  }, React.createElement(TextInput, {\n    style: styles.inputText,\n    placeholder: \"Add New Jar\",\n    placeholderTextColor: \"#888\",\n    value: state.jarname,\n    onChangeText: function onChangeText(text) {\n      return setState(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, {\n          jarname: text\n        });\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 11\n    }\n  })), React.createElement(TouchableOpacity, {\n    onPress: function onPress() {\n      return onAddJar();\n    },\n    style: styles.addBtnShr,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 11\n    }\n  }, \"ADD\"))));\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    alignItems: \"center\",\n    backgroundColor: \"#f2f2f2\",\n    width: \"100%\",\n    height: \"100%\",\n    marginTop: constants.statusBarHeight\n  },\n  card: {\n    width: \"95%\",\n    height: 80,\n    backgroundColor: \"#fff\",\n    borderRadius: 5,\n    elevation: 5,\n    margin: 10\n  },\n  pill: {\n    flex: 2,\n    backgroundColor: \"lightgreen\",\n    padding: 5,\n    borderRadius: 5,\n    maxWidth: 65,\n    display: \"flex\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    marginRight: 20\n  },\n  addBtn: {\n    backgroundColor: \"#fb5b5a\",\n    width: \"90%\",\n    margin: 15,\n    padding: 15,\n    borderRadius: 5,\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"space-between\"\n  },\n  addBtnShr: {\n    backgroundColor: \"#fb5b5a\",\n    height: 50,\n    width: \"20%\",\n    padding: 1,\n    borderRadius: 5,\n    display: \"flex\",\n    alignItems: \"center\",\n    margin: 20,\n    justifyContent: \"center\"\n  },\n  addWrapper: {\n    display: \"flex\",\n    flexDirection: \"row\"\n  },\n  inputView: {\n    width: \"65%\",\n    backgroundColor: \"#fff\",\n    borderRadius: 5,\n    borderWidth: 1,\n    borderColor: \"#fb5b5a\",\n    height: 50,\n    marginVertical: 20,\n    marginLeft: 20,\n    justifyContent: \"center\",\n    padding: 20\n  },\n  inputText: {\n    height: 45,\n    color: \"#000\"\n  },\n  jarNameContainer: {\n    flexDirection: \"row\",\n    marginVertical: 30\n  },\n  jarText: {\n    flex: 1,\n    fontSize: 16,\n    marginLeft: 20\n  }\n});","map":{"version":3,"sources":["C:/Users/ammar/Pictures/groceryApp/client/screens/admin/Home.js"],"names":["React","useEffect","useState","constants","Icon","AsyncStorage","useDispatch","Home","props","loading","edit","jarNames","currlevel","jarname","adminID","iotToken","state","setState","dispatch","getAdminId","JSON","getItem","afterParse","parse","adminId","console","log","prevState","fetchData","fetch","global","ipAddress","then","res","json","resJson","catch","e","getValues","val","SendMail","onAddJar","method","headers","body","stringify","jarName","text","onDelete","handleRefresh","renderSeparator","marginBottom","item","index","type","payload","key","navigation","navigate","styles","card","jarNameContainer","jarText","pill","value","jars","marginRight","addWrapper","inputView","inputText","addBtnShr","StyleSheet","create","container","flex","alignItems","backgroundColor","width","height","marginTop","statusBarHeight","borderRadius","elevation","margin","padding","maxWidth","display","justifyContent","addBtn","flexDirection","borderWidth","borderColor","marginVertical","marginLeft","color","fontSize"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport constants from \"expo-constants\";\r\nimport {\r\n  StyleSheet,\r\n  FlatList,\r\n  View,\r\n  Text,\r\n  TouchableOpacity,\r\n  TextInput,\r\n} from \"react-native\";\r\nimport Icon from \"react-native-vector-icons/AntDesign\";\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\n\r\nimport \"../../global\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nexport default function Home(props) {\r\n  const [state, setState] = useState({\r\n    loading: true,\r\n    edit: false,\r\n    jarNames: \"\",\r\n    currlevel: \"\",\r\n    jarname: \"\",\r\n    adminID: \"\",\r\n    iotToken:''\r\n  });\r\n  const dispatch = useDispatch();\r\n  useEffect(() => {\r\n    getAdminId();\r\n  }, []);\r\n\r\n  const getAdminId = async () => {\r\n    const afterParse = JSON.parse(await AsyncStorage.getItem(\"item\"));\r\n    const adminId = afterParse.adminId;\r\n    const iotToken = afterParse.iotToken;\r\n    console.log(\"Admin ID: \" + adminId);\r\n    console.log(\"Iot Token: \" + iotToken);\r\n    setState((prevState) => {\r\n      return { ...prevState, adminID: adminId,iotToken:iotToken};\r\n    });\r\n    fetchData(adminId);\r\n  };\r\n\r\n  const fetchData = (adminId) => {\r\n    setState((prevState) => {\r\n      return { ...prevState, loading: true };\r\n    });\r\n    fetch(`${global.ipAddress}:3001/getHomeData/` + adminId)\r\n      .then((res) => res.json())\r\n      .then((resJson) => {\r\n        console.log(resJson);\r\n        setState((prevState) => {\r\n          return { ...prevState, jarNames: resJson, loading: false };\r\n        });\r\n\r\n        console.log(\"Loading is \" + state.loading);\r\n      })\r\n      .catch((e) => console.log(e));\r\n  };\r\n\r\n  const getValues = (val) => {\r\n    if (val >= 0 && val <= 10) {\r\n      SendMail();\r\n      return <Text>high</Text>;\r\n    } else if (val >= 11 && val <= 16) {\r\n      return <Text>Medium</Text>;\r\n    } else if (val >= 17 && val <=22) {\r\n      return <Text>low</Text>;\r\n    }\r\n    else { return <Text >Invalid</Text> }\r\n  };\r\n\r\n  const onAddJar = () => {\r\n    setState((prevState) => {\r\n      return { ...prevState, jarname: \"\" };\r\n    });\r\n    fetch(`${global.ipAddress}:3001/addJar/` + state.adminID, {\r\n      method: \"PUT\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({\r\n        jarName: state.jarname,\r\n      }),\r\n    })\r\n      .then((res) => res.json())\r\n      .then((resJson) => {\r\n        console.log(resJson);\r\n        console.log(\"added\");\r\n      })\r\n      .catch((e) => console.log(e));\r\n  };\r\n\r\n  const SendMail = () => {\r\n    fetch(`${global.ipAddress}:3001/sendMail/` + state.adminID, {\r\n      method: \"GET\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    })\r\n      .then((res) => res.text())\r\n      .then((resJson) => {\r\n        console.log(resJson);\r\n      });\r\n  };\r\n\r\n  const onDelete = (jarName) => {\r\n    setState((prevState) => {\r\n      return { ...prevState, edit: false };\r\n    });\r\n\r\n    fetchData();\r\n    fetch(\r\n      `${global.ipAddress}:3001/deleteJarItem/` + state.adminID + \"/\" + jarName,\r\n      {\r\n        method: \"PUT\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      }\r\n    )\r\n      .then((res) => res.json())\r\n      .then((resJson) => {\r\n        console.log(resJson);\r\n      })\r\n      .catch((e) => console.log(e));\r\n  };\r\n\r\n  const handleRefresh = () => {\r\n    getAdminId();\r\n  };\r\n\r\n  const renderSeparator = () => (\r\n    <View\r\n      style={{\r\n        marginBottom: -10,\r\n      }}\r\n    />\r\n  );\r\n\r\n  return (\r\n    <>\r\n      <FlatList\r\n        refreshing={state.loading}\r\n        onRefresh={handleRefresh}\r\n        data={state.jarNames}\r\n        renderItem={({ item, index }) => (\r\n          <TouchableOpacity\r\n            key={index}\r\n            onPress={() => {\r\n              dispatch({ type: \"navigate\", payload: { jarname: item.key , iotToken: item.iotToken } });\r\n              props.navigation.navigate(\"History\", item);\r\n            }}\r\n            onLongPress={() =>\r\n              setState((prevState) => {\r\n                return { ...prevState, edit: true };\r\n              })\r\n            }\r\n            style={styles.card}\r\n          >\r\n            <View style={styles.jarNameContainer}>\r\n              <Text style={styles.jarText}>{item.key}</Text>\r\n              <View style={styles.pill}>{getValues(item.value)}</View>\r\n              {state.edit ? (\r\n                <Icon\r\n                  onPress={() => onDelete(item.jars)}\r\n                  style={{ marginRight: 20 }}\r\n                  name=\"close\"\r\n                  size={19}\r\n                  color=\"red\"\r\n                />\r\n              ) : null}\r\n            </View>\r\n          </TouchableOpacity>\r\n        )}\r\n        ItemSeparatorComponent={renderSeparator}\r\n      />\r\n      <View style={styles.addWrapper}>\r\n        <View style={styles.inputView}>\r\n          <TextInput\r\n            style={styles.inputText}\r\n            placeholder=\"Add New Jar\"\r\n            placeholderTextColor=\"#888\"\r\n            value={state.jarname}\r\n            onChangeText={(text) =>\r\n              setState((prevState) => {\r\n                return { ...prevState, jarname: text };\r\n              })\r\n            }\r\n          />\r\n        </View>\r\n        <TouchableOpacity onPress={() => onAddJar()} style={styles.addBtnShr}>\r\n          <Text>ADD</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n    </>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    alignItems: \"center\",\r\n    backgroundColor: \"#f2f2f2\",\r\n    width: \"100%\",\r\n    height: \"100%\",\r\n    marginTop:constants.statusBarHeight,\r\n  },\r\n  card: {\r\n    width: \"95%\",\r\n    height: 80,\r\n    backgroundColor: \"#fff\",\r\n    borderRadius: 5,\r\n    elevation: 5,\r\n    margin: 10,\r\n  },\r\n  pill: {\r\n    flex: 2,\r\n    backgroundColor: \"lightgreen\",\r\n    padding: 5,\r\n    borderRadius: 5,\r\n    maxWidth: 65,\r\n    display: \"flex\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    marginRight: 20,\r\n  },\r\n  addBtn: {\r\n    backgroundColor: \"#fb5b5a\",\r\n    width: \"90%\",\r\n    margin: 15,\r\n    padding: 15,\r\n    borderRadius: 5,\r\n    display: \"flex\",\r\n    flexDirection: \"row\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"space-between\",\r\n  },\r\n  addBtnShr: {\r\n    backgroundColor: \"#fb5b5a\",\r\n    height: 50,\r\n    width: \"20%\",\r\n    padding: 1,\r\n    borderRadius: 5,\r\n    display: \"flex\",\r\n    alignItems: \"center\",\r\n    margin: 20,\r\n    justifyContent: \"center\",\r\n  },\r\n  addWrapper: { display: \"flex\", flexDirection: \"row\" },\r\n  inputView: {\r\n    width: \"65%\",\r\n    backgroundColor: \"#fff\",\r\n    borderRadius: 5,\r\n    borderWidth: 1,\r\n    borderColor: \"#fb5b5a\",\r\n    height: 50,\r\n    marginVertical: 20,\r\n    marginLeft: 20,\r\n    justifyContent: \"center\",\r\n    padding: 20,\r\n  },\r\n  inputText: { height: 45, color: \"#000\" },\r\n  jarNameContainer: { flexDirection: \"row\", marginVertical: 30 },\r\n  jarText: { flex: 1, fontSize: 16, marginLeft: 20 },\r\n});\r\n"]},"metadata":{},"sourceType":"module"}